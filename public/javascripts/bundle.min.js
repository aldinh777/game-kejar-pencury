(function(){function e(t,o,n){function i(r,s){if(!o[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(a)return a(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var m=o[r]={exports:{}};t[r][0].call(m.exports,function(e){var o=t[r][1][e];return i(o||e)},m,m.exports,e,t,o,n)}return o[r].exports}for(var a="function"==typeof require&&require,r=0;r<n.length;r++)i(n[r]);return i}return e})()({1:[function(e,t,o){const n=e("../lib/Entity");t.exports=class e extends n{constructor(e,t,o,n,i,a){super(e,o,n,i,a);this.speed=t||10;this.direction="none"}slide(){if(!this.isMoving){this.isMoving=true;this.direction=this.queueDirection;this.queueDirection="none";const e=setInterval(()=>{switch(this.direction){case"left":this.element.style.transform="scale(-1, 1)";super.moveLeft();break;case"right":this.element.style.transform="scale(1, 1)";super.moveRight();break;case"up":super.moveUp();break;case"down":super.moveDown();break;case"none":clearInterval(e);this.isMoving=false;if(this.queueDirection!="none"){this.slide()}}},1e3/this.speed)}}stop(){this.direction="none"}moveLeft(){this.queueDirection="left";this.slide()}moveRight(){this.queueDirection="right";this.slide()}moveUp(){this.queueDirection="up";this.slide()}moveDown(){this.queueDirection="down";this.slide()}}},{"../lib/Entity":6}],2:[function(e,t,o){const n=e("../lib/Entity");class i extends n{constructor(e,t,o,n){super(e,0,t,o,n);this.deleteKeymap("left");this.deleteKeymap("right");this.deleteKeymap("up");this.deleteKeymap("down");i.layer.appendChild(e)}static drawPoint(e,t){i.walls.push(new i(n.createElement("div",{className:"wall"}),{x:e*i.gap,y:t*i.gap},{x:32,y:32}))}static drawVerticalLine(e,t,o){for(let n=0;n<o;n++){i.drawPoint(e,t+n)}}static drawHorizontalLine(e,t,o){for(let n=0;n<o;n++){i.drawPoint(e+n,t)}}static sign(e,t){for(const o of i.walls){e.onCollision(o,t)}}static clearAll(){while(i.walls.length){const e=i.walls.pop();i.layer.removeChild(e.element)}}}i.walls=new Array;i.gap=32;t.exports=i},{"../lib/Entity":6}],3:[function(e,t,o){const n=e("../lib/Card");const i=e("./Play");const a=e("../entity/WallEntity");const r=e("../lib/XHRApi");class s{static title(){n.create("main-menu",new n("Game Kejar-Kejaran",[n.button("","main.png",()=>n.show("play")),n.button("","cara main.png",()=>n.show("control")),n.button("","credit.png",()=>n.show("about"))]));n.create("play",new n("Play",[n.button("","online.png",()=>n.show("online")),n.button("","offline.png",()=>{document.getElementById("main").style.backgroundImage=`url('/images/gajaraya/background.png')`;document.getElementById("main").style.backgroundSize=`32px 32px')`;n.hide();i.offline()}),n.backButton("Kembali",()=>n.show("main-menu"))]));n.create("control",new n("Play",[n.label("Pengejar"),n.pre("\ta : Kiri | w : Atas | d : Kanan | s : Bawah"),n.label("Pelari"),n.pre("\tj : Kiri | i : Atas | l : Kanan | k : Bawah"),n.backButton("Kembali",()=>n.show("main-menu"))]));n.create("help",new n("Help",[n.pre("\tApabila pengejar berhasil menangkap pelari,\n"+"\tmaka pengejar yang menang\n"+"\n"+"\tNamun apabila waktu habis terlebih dahulu\n"+"\tmaka pelari yang menang\n"),n.backButton("Kembali",()=>n.show("main-menu"))]));n.create("about",new n("About",[n.label("Director : Muhamad Rizal"),n.label("Designer : Reyhan Yulianata"),n.label("Programmer : Aldi Nur Hendra"),n.backButton("Kembali",()=>n.show("main-menu"))]))}static online(){const e=new r;const t=document.createElement("pre");const o=document.createElement("pre");const a=n.button("Mulai",()=>{e.post("/api/room/"+s.roomName+"/start",{},e=>{document.getElementById("main").style.backgroundImage=`url('/images/gajaraya/background.png')`;document.getElementById("main").style.backgroundSize=`32px 32px'`;n.hide();i.online(s.roomName,s.yourRole);console.log(e)})});n.create("online",new n("Online",[n.button("","buat room.png",()=>n.show("room@create")),n.button("","cari room.png",()=>n.show("room@join")),n.backButton("Kembali",()=>n.show("play"))]));n.create("room@create",new n("Buat Room",[n.label("Masukkan Nama Room"),n.input("roomCreate"),n.button("","buat room.png",()=>{const o=n.value("roomCreate");if(o){s.roomName=o;s.yourRole="chaser";s.enemyRole="runner";e.post("/api/room/create",{name:s.roomName,host:s.yourRole,guest:s.enemyRole},o=>{while(t.lastChild){t.removeChild(t.lastChild)}e.get("/api/room/"+s.roomName+"/wait",e=>{a.removeAttribute("disabled");console.log(e)});const i=s.yourRole=="chaser"?"Pengejar":"Pelari";const r=s.enemyRole=="chaser"?"Pengejar":"Pelari";t.appendChild(document.createTextNode("\t\tHost : "+i+"\n"));t.appendChild(document.createTextNode("\t\tGuest : "+r+"\n"));a.setAttribute("disabled","disabled");n.show("room@host-waiting");console.log(o)})}else{alert("Harap isi Nama Room")}}),n.backButton("Kembali",()=>n.show("online"))]));n.create("room@join",new n("Join Room",[n.label("Masukkan Nama Room"),n.input("roomJoin"),n.button("","cari room.png",()=>{const t=n.value("roomJoin");s.roomName=t;e.get("/api/room/"+s.roomName+"/join",t=>{if(t=="Not Found"){alert("Room Not Found")}else{const a=()=>{e.get("/api/room/"+s.roomName+"/switch",e=>{const t=JSON.parse(e);s.yourRole=t.guest;s.enemyRole=t.host;while(o.lastChild){o.removeChild(o.lastChild)}const n=s.yourRole=="chaser"?"Pengejar":"Pelari";const i=s.enemyRole=="chaser"?"Pengejar":"Pelari";o.appendChild(document.createTextNode("\t\tHost : "+i+"\n"));o.appendChild(document.createTextNode("\t\tGuest : "+n+"\n"));a();console.log(e)})};const r=JSON.parse(t);s.yourRole=r.guest;s.enemyRole=r.host;while(o.lastChild){o.removeChild(o.lastChild)}const l=s.yourRole=="chaser"?"Pengejar":"Pelari";const c=s.enemyRole=="chaser"?"Pengejar":"Pelari";o.appendChild(document.createTextNode("\t\tHost : "+c+"\n"));o.appendChild(document.createTextNode("\t\tGuest : "+l+"\n"));n.show("room@guest-waiting");e.get("/api/room/"+s.roomName+"/waitPlay",e=>{n.hide();i.online(s.roomName,s.yourRole);console.log(e)});a();console.log(t)}})}),n.backButton("Kembali",()=>n.show("play"))]));n.create("room@host-waiting",new n("Nama Room",[t,n.button("Tukar Role",()=>{if(s.yourRole=="chaser"){s.yourRole="runner";s.enemyRole="chaser"}else{s.yourRole="chaser";s.enemyRole="runner"}while(t.lastChild){t.removeChild(t.lastChild)}const o=s.yourRole=="chaser"?"Pengejar":"Pelari";const n=s.enemyRole=="chaser"?"Pengejar":"Pelari";e.post("/api/room/switch",{name:s.roomName,host:s.yourRole,guest:s.enemyRole},e=>{t.appendChild(document.createTextNode("\t\tHost : "+o+"\n"));t.appendChild(document.createTextNode("\t\tGuest : "+n+"\n"));console.log(e)})}),a,n.backButton("Keluar",()=>n.show("room@create"))]));n.create("room@guest-waiting",new n("Nama Room",[o,n.button("Siap",()=>{e.post("/api/room/"+s.roomName+"/ready",{status:"ready"},e=>{console.log(e)})}),n.backButton("Keluar",()=>n.show("room@join"))]))}static offline(){n.create("offline@chaser-win",new n("Pengejar Menang",[n.backButton("Keluar",()=>{location.reload()})]));n.create("offline@runner-win",new n("Pelari Menang",[n.backButton("Keluar",()=>{location.reload()})]))}}t.exports=s},{"../entity/WallEntity":2,"../lib/Card":5,"../lib/XHRApi":7,"./Play":4}],4:[function(e,t,o){const n=e("../entity/SlideEntity");const i=e("../lib/Entity");const a=e("../entity/WallEntity");const r=e("../lib/Card");const s=e("../lib/XHRApi");class l{static timerStart(){let e=l.globalTimeLimit;const t=()=>{e--;if(e<=0){clearInterval(l.countStart);l.pengejar.destroy();r.show("offline@runner-win")}};l.countStart=setInterval(t,1e3)}static initialMap(){a.drawHorizontalLine(0,0,32);a.drawHorizontalLine(0,19,32);a.drawVerticalLine(0,0,20);a.drawVerticalLine(31,0,20);a.drawHorizontalLine(31-10,5,6);a.drawVerticalLine(5,1,5);a.drawVerticalLine(31-5,1,5);a.drawHorizontalLine(6,19-5,6);a.drawVerticalLine(5,19-5,5);a.drawVerticalLine(31-5,19-5,5);a.drawPoint(4,7);a.drawPoint(6,6);a.drawPoint(20,14);a.drawPoint(12,5);a.drawPoint(31-6,19-6);a.drawPoint(31-4,19-7)}static online(e,t){l.pengejar=new n(i.createElement("div",{id:"chaser"}),1e3,4,{x:1*32,y:1*32},{x:32,y:32});l.pelari=new n(i.createElement("div",{id:"runner"}),1e3,4,{x:30*32,y:1*32},{x:32,y:32});l.initialMap();a.sign(l.pengejar,()=>{l.pengejar.stop();return true});a.sign(l.pelari,()=>{l.pelari.stop();return true});l.pengejar.onBothCollision(l.pelari,()=>{clearInterval(l.countStart);l.pelari.destroy();r.show("offline@chaser-win");return true});const o=()=>{const t=new s;t.get("/api/room/"+e+"/watch",e=>{const t=JSON.parse(e);const n=t.role=="chaser"?l.pengejar:l.pelari;switch(t.dir){case"left":n.moveLeft();break;case"up":n.moveUp();break;case"right":n.moveRight();break;case"down":n.moveDown();break}o()})};console.log(t);if(t=="chaser"){l.pelari.deleteKeymap("left");l.pelari.deleteKeymap("up");l.pelari.deleteKeymap("right");l.pelari.deleteKeymap("down");l.pengejar.remap("left","a",()=>{const t=new s;t.post("/api/room/"+e+"/move",{dir:"left",role:"chaser"},e=>{console.log(e)})});l.pengejar.remap("up","w",()=>{const t=new s;t.post("/api/room/"+e+"/move",{dir:"up",role:"chaser"},e=>{console.log(e)})});l.pengejar.remap("right","d",()=>{const t=new s;t.post("/api/room/"+e+"/move",{dir:"right",role:"chaser"},e=>{console.log(e)})});l.pengejar.remap("down","s",()=>{const t=new s;t.post("/api/room/"+e+"/move",{dir:"down",role:"chaser"},e=>{console.log(e)})})}else{l.pengejar.deleteKeymap("left");l.pengejar.deleteKeymap("up");l.pengejar.deleteKeymap("right");l.pengejar.deleteKeymap("down");l.pelari.remap("left","a",()=>{const t=new s;t.post("/api/room/"+e+"/move",{dir:"left",role:"runner"},e=>{console.log(e)})});l.pelari.remap("up","w",()=>{const t=new s;t.post("/api/room/"+e+"/move",{dir:"up",role:"runner"},e=>{console.log(e)})});l.pelari.remap("right","d",()=>{const t=new s;t.post("/api/room/"+e+"/move",{dir:"right",role:"runner"},e=>{console.log(e)})});l.pelari.remap("down","s",()=>{const t=new s;t.post("/api/room/"+e+"/move",{dir:"down",role:"runner"},e=>{console.log(e)})})}o();l.timerStart()}static offline(){l.pengejar=new n(i.createElement("div",{id:"chaser"}),1e3,4,{x:1*32,y:1*32},{x:32,y:32});l.pelari=new n(i.createElement("div",{id:"runner"}),1e3,4,{x:30*32,y:1*32},{x:32,y:32});l.initialMap();l.pelari.remap("left","j");l.pelari.remap("up","i");l.pelari.remap("right","l");l.pelari.remap("down","k");a.sign(l.pengejar,()=>{l.pengejar.stop();return true});a.sign(l.pelari,()=>{l.pelari.stop();return true});l.pengejar.onBothCollision(l.pelari,()=>{clearInterval(l.countStart);l.pelari.destroy();r.show("offline@chaser-win");return true});l.timerStart()}}l.globalTimeLimit=20;t.exports=l},{"../entity/SlideEntity":1,"../entity/WallEntity":2,"../lib/Card":5,"../lib/Entity":6,"../lib/XHRApi":7}],5:[function(e,t,o){class n{constructor(e,t){const o=document.createElement("div");o.classList.add("card");this.elem=o;const n=document.createElement("div");n.classList.add("title");n.appendChild(document.createTextNode(e));o.appendChild(n);o.appendChild(document.createElement("hr"));const i=document.createElement("div");i.classList.add("option");for(const e of t){i.appendChild(e)}o.appendChild(i)}static create(e,t){this.keyCards.push({name:e,card:t})}static replace(e,t){this.keyCards=this.keyCards.map(o=>{if(o.name==e){return{name:e,card:t}}return o})}static delete(e){this.keyCards=this.keyCards.filter(t=>{return t.name!=e})}static show(e){this.hide();for(const t of this.keyCards){if(t.name==e){this.layer.appendChild(t.card.elem);this.currentCard=t.card;return}}throw new Error('Card "'+e+'" not Found')}static hide(){if(this.currentCard){this.layer.removeChild(this.currentCard.elem);this.currentCard=null}}static button(e,t,o){const n=document.createElement("button");if(o){n.style.backgroundImage=`url('/images/gajaraya/${t}')`;n.style.backgroundSize=`100% 100%`}else{o=t}n.appendChild(document.createTextNode(e));n.onclick=o;return n}static backButton(e,t){const o=this.button(e,t);o.classList.add("back");return o}static label(e){const t=document.createElement("div");t.classList.add("label");t.appendChild(document.createTextNode(e));return t}static pre(e){const t=document.createElement("pre");t.appendChild(document.createTextNode(e));return t}static input(e){const t=document.createElement("input");t.id=e;return t}static value(e){const t=document.getElementById(e);if(!t){throw new Error("input with ID "+e+" was not found")}return t.value}}n.layer=document.getElementById("main");n.keyCards=new Array;t.exports=n},{}],6:[function(e,t,o){const n=new Array;window.onkeydown=function(e){for(const t of n){for(const o of t.getKeymaps()){if(o.key.toUpperCase()==e.key.toUpperCase()){o.callback(e)}}}};class i{constructor(e,t,o,i,a){this.keyMaps=[{name:"right",key:"d",callback:()=>{this.moveRight()}},{name:"left",key:"a",callback:()=>{this.moveLeft()}},{name:"down",key:"s",callback:()=>{this.moveDown()}},{name:"up",key:"w",callback:()=>{this.moveUp()}}];this.collisionListeners=new Array;this.element=e;this.range=t||(t==0?0:1);this.position=o||{x:0,y:0};this.hitbox=i||{x:0,y:0};this.hitboxStart=a||{x:0,y:0};this.move(this.position.x,this.position.y);n.push(this)}static createElement(e,t){const o=document.createElement(e);if(t){for(const e in t){const n=e=="id"?document.getElementById(t["id"]):null;if(n){return n}else{o[e]=t[e]}}}o.classList.add("entity");this.layer.appendChild(o);return o}checkCollision(e,t){for(const o of this.collisionListeners){const n=this.getHitbox(e,t);const i=o.entity.getHitbox();const a=n.maxX>i.minX&&n.minX<i.maxX;const r=n.maxY>i.minY&&n.minY<i.maxY;if(a&&r){if(o.callback()){return true}}}return false}move(e,t){if(this.checkCollision(e,t)){return}this.position.x=e;this.position.y=t;this.element.style.left=this.position.x+"px";this.element.style.top=this.position.y+"px"}moveRight(){this.move(this.position.x+this.range,this.position.y)}moveLeft(){this.move(this.position.x-this.range,this.position.y)}moveDown(){this.move(this.position.x,this.position.y+this.range)}moveUp(){this.move(this.position.x,this.position.y-this.range)}getHitbox(e,t){return{minX:(e==0?0:e||this.position.x)+this.hitboxStart.x,minY:(t==0?0:t||this.position.y)+this.hitboxStart.y,maxX:(e==0?0:e||this.position.x)+this.hitbox.x,maxY:(t==0?0:t||this.position.y)+this.hitbox.y}}addKeymap(e,t,o){this.keyMaps.push({name:e,key:t,callback:o})}deleteKeymap(e){this.keyMaps=this.keyMaps.filter(t=>{return t.name!=e})}getKeymaps(){return this.keyMaps}remap(e,t,o){this.keyMaps=this.keyMaps.map(n=>{if(n.name==e){return{name:e,key:t,callback:o||n.callback}}return n})}destroy(){this.position={x:0,y:0};this.hitbox={x:0,y:0};this.hitboxStart={x:0,y:0};this.element.parentNode.removeChild(this.element);this.keyMaps=[]}onCollision(e,t){this.collisionListeners.push({entity:e,callback:t})}onBothCollision(e,t){this.collisionListeners.push({entity:e,callback:t});e.collisionListeners.push({entity:this,callback:t})}}i.layer=document.getElementById("main");t.exports=i},{}],7:[function(e,t,o){class n{request(e,t,o,n){this.xhr=new XMLHttpRequest;this.xhr.open(e,t);this.xhr.onreadystatechange=(()=>{if(this.xhr.readyState==this.xhr.DONE){n(this.xhr.response)}});this.xhr.setRequestHeader("Content-Type","application/json");this.xhr.send(o)}get(e,t){this.request("GET",e,null,t)}post(e,t,o){this.request("POST",e,JSON.stringify(t),o)}}t.exports=n},{}],8:[function(e,t,o){const n=e("./init/Cards");const i=e("./lib/Card");n.title();n.online();n.offline();i.show("main-menu");document.getElementById("main").style.backgroundSize=`100% 100%`},{"./init/Cards":3,"./lib/Card":5}]},{},[8]);